<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>变量作用域，闭包 | CD&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/vuepress-interview-github/img/pig.svg">
    <script data-ad-client="ca-pub-7828333725993554" async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="description" content="三天打了渔，两天下了雨">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/vuepress-interview-github/assets/css/0.styles.17ae7d79.css" as="style"><link rel="preload" href="/vuepress-interview-github/assets/js/app.4e548d7f.js" as="script"><link rel="preload" href="/vuepress-interview-github/assets/js/2.e83f1016.js" as="script"><link rel="preload" href="/vuepress-interview-github/assets/js/216.fe74516c.js" as="script"><link rel="prefetch" href="/vuepress-interview-github/assets/js/10.d7dfa765.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/100.87752dc4.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/101.f9e149cd.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/102.c65876ad.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/103.1d07ca7b.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/104.a214da58.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/105.10bb8d00.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/106.528de86c.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/107.a34d898d.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/108.ae12003c.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/109.71af1e6c.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/11.55615da5.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/110.959e86bf.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/111.9a1697e1.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/112.bdf31828.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/113.67dfd0a2.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/114.4c2813ea.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/115.39d8cd2f.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/116.55f0c633.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/117.a2d4f915.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/118.defc6908.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/119.22c0a558.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/12.8b17a15c.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/120.0a1f86e5.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/121.e7d0d6de.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/122.4340844f.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/123.9febecee.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/124.7c9a0688.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/125.ab44f78c.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/126.c7fbed82.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/127.e6d39dd5.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/128.c3fd119c.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/129.6eb97549.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/13.b8233548.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/130.1d0fbb1d.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/131.598516eb.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/132.23631dfb.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/133.c20dc8de.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/134.ac89c88e.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/135.eeec6025.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/136.78ae0f00.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/137.5f0e0672.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/138.8e778af4.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/139.9d399443.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/14.ffbae826.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/140.a4d403d5.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/141.143f1af5.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/142.6c6b36ea.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/143.f3370b84.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/144.a61af7fb.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/145.eca5234b.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/146.81eb91cb.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/147.96d077d2.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/148.ad7435c5.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/149.2b301592.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/15.f93028de.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/150.b87890f0.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/151.a528b721.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/152.258302af.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/153.dca29069.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/154.8b60c800.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/155.c4f470ef.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/156.6e91f71f.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/157.e223dd1f.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/158.744fa854.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/159.d4f9161c.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/16.4e37820e.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/160.e3c68e02.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/161.14892d12.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/162.218f6978.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/163.c4ce472a.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/164.4dfa707a.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/165.93797dea.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/166.fc5c93ee.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/167.8e199360.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/168.44b5bd08.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/169.42095d3f.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/17.afa834cc.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/170.64e91dfc.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/171.958200d2.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/172.9cadd6ca.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/173.c8c106ff.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/174.b64969cb.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/175.3c6364de.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/176.b463f964.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/177.ecfe39c3.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/178.af84e1b1.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/179.092235ff.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/18.cb2c9d3b.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/180.c963876d.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/181.5eadfe5f.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/182.cb5fb418.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/183.02d1fd73.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/184.6c4742e1.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/185.5070fbe0.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/186.12c761af.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/187.e69c9737.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/188.edc0ca12.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/189.c0b4eb57.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/19.c82bfe60.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/190.2f230299.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/191.928d225d.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/192.732edec2.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/193.974a725b.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/194.1e195ce2.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/195.e27627a1.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/196.6113d70d.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/197.f4738422.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/198.52daeabd.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/199.62945421.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/20.deb57042.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/200.938d5378.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/201.9dbd96de.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/202.e08efa54.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/203.1741b6ff.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/204.86d11599.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/205.bc73aef9.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/206.205b93c5.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/207.803f8248.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/208.90f416d4.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/209.ee692a92.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/21.18b9cd04.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/210.793f91fc.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/211.0c493e81.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/212.2026e656.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/213.686aa004.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/214.6295dee0.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/215.21f85bab.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/217.64cf836f.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/218.a297200b.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/219.fa3bb8c9.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/22.b3c78432.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/220.1410c75f.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/221.45a2aa18.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/222.fc749cfc.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/223.5e1e9206.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/224.6ad6c5c9.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/225.e98bcd91.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/226.1b51d4ce.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/227.a720bd91.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/228.14605392.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/229.21bf72fa.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/23.d2e4be55.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/230.7cb874ec.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/231.09c5808e.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/232.80aa5e6c.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/233.19c70b10.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/234.59412d51.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/235.291a7ced.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/236.57802856.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/237.919ad298.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/238.326d5459.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/239.87c0d062.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/24.d3b58261.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/240.e7655913.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/241.e22515cb.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/242.e2411e58.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/243.649eae26.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/244.178d14ad.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/245.ec26dd90.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/246.5783d397.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/247.77a345cd.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/248.261ea5a2.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/249.abd32009.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/25.58589374.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/250.0cda849c.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/251.70c93adc.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/252.fea7a591.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/253.e0e74243.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/254.754488e3.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/255.d5030039.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/256.efad9799.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/257.3be49a18.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/258.d7a873c8.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/259.d1f19f97.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/26.a91ce644.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/260.ea67be7f.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/261.e2a5ad21.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/262.c2aea5f5.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/263.c99c41b2.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/264.597bb54d.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/265.cd9acbc3.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/266.d07b6a84.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/267.428b9982.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/27.94591cf3.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/28.3ec0bcb0.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/29.ea23addb.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/3.b2b47b41.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/30.25e291d9.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/31.f80c4080.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/32.935161cd.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/33.58eae9e8.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/34.6d3718c7.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/35.fb170f99.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/36.871ba28a.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/37.89f806fb.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/38.2bb5882e.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/39.51f838e5.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/4.982dd553.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/40.7b9d4587.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/41.8baaa1de.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/42.1cceab65.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/43.160a5caf.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/44.5c7aef19.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/45.4c621ba5.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/46.f341081c.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/47.a9138e88.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/48.0495159e.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/49.cdff06a2.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/5.9b23545a.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/50.f916ce18.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/51.7f028f80.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/52.530f0b91.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/53.1bc3eacb.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/54.815c9ef9.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/55.36b17e74.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/56.7566dc15.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/57.4377ddcc.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/58.f7806bde.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/59.84076057.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/6.06e2dbd7.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/60.55393ed8.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/61.0e8b328f.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/62.7936e59b.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/63.fddf7c64.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/64.46be0284.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/65.afa8b76c.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/66.bfad8276.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/67.cdc1419b.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/68.3216be90.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/69.1846a4c2.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/7.ab329d7c.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/70.d18c1d91.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/71.0feb36b6.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/72.576d73ef.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/73.b03a5376.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/74.933fe977.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/75.efd8f1a4.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/76.7760dc9f.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/77.7c94c2d2.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/78.52ffcd1e.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/79.548593ff.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/8.cbc1b8c8.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/80.2c14912c.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/81.f1b5e07d.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/82.a61a423b.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/83.dc3e1553.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/84.12fb8f49.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/85.d6dc2da0.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/86.fef350b6.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/87.4ae66853.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/88.46cb9b40.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/89.75d4aa79.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/9.680f7e3a.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/90.2d3c345c.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/91.18bb5a4a.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/92.8cb1ca0e.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/93.647957ae.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/94.0fcfe396.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/95.fb024fe4.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/96.a8b363b1.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/97.a16ab031.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/98.15cf5028.js"><link rel="prefetch" href="/vuepress-interview-github/assets/js/99.58151768.js">
    <link rel="stylesheet" href="/vuepress-interview-github/assets/css/0.styles.17ae7d79.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress-interview-github/" class="home-link router-link-active"><img src="/vuepress-interview-github/assets/icon.jpg" alt="CD's blog" class="logo"> <span class="site-name can-hide">CD's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress-interview-github/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="	🐳前端知识点" class="dropdown-title"><a href="/vuepress-interview-github/interview/" class="link-title">	🐳前端知识点</a> <span class="title" style="display:none;">	🐳前端知识点</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/html/" class="nav-link">HTMLCSS</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/js/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/ts/" class="nav-link">TypeScript</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/react/" class="nav-link">React</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/node/" class="nav-link">Node</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/webpack/" class="nav-link">Webpack</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/git/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/nestjs/" class="nav-link">Nestjs</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/miniprogram/" class="nav-link">小程序</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/browser/" class="nav-link">浏览器网络</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🤖相关书籍" class="dropdown-title"><a href="/vuepress-interview-github/web/" class="link-title">🤖相关书籍</a> <span class="title" style="display:none;">🤖相关书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress-interview-github/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/vuepress-interview-github/note/Webpack/" class="nav-link">Webpack笔记</a></li></ul></li><li class="dropdown-item"><h4>JS/TS教程</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress-interview-github/note/break/" class="nav-link">《现代JavaScript》教程</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/vuepress-interview-github/tools/" class="nav-link">🔧工具方法</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🍎收藏" class="dropdown-title"><a href="/vuepress-interview-github/pages/beb6c0bd8a66cea6/" class="link-title">🍎收藏</a> <span class="title" style="display:none;">🍎收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/pages/beb6c0bd8a66cea6/" class="nav-link">网站</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/pages/eee83a9211a70f9d/" class="nav-link">资源</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/pages/12df8ace52d493f6/" class="nav-link">Vue资源</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🌐索引" class="dropdown-title"><a href="/vuepress-interview-github/archives/" class="link-title">🌐索引</a> <span class="title" style="display:none;">🌐索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com//caidix/vuepress-interview-github" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/vuepress-interview-github/assets/icon.jpg"> <div class="blogger-info"><h3>CD_wOw</h3> <span>内卷的行情，到不了的梦</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/vuepress-interview-github/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="	🐳前端知识点" class="dropdown-title"><a href="/vuepress-interview-github/interview/" class="link-title">	🐳前端知识点</a> <span class="title" style="display:none;">	🐳前端知识点</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/html/" class="nav-link">HTMLCSS</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/js/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/ts/" class="nav-link">TypeScript</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/react/" class="nav-link">React</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/node/" class="nav-link">Node</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/webpack/" class="nav-link">Webpack</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/git/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/nestjs/" class="nav-link">Nestjs</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/miniprogram/" class="nav-link">小程序</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/interview/browser/" class="nav-link">浏览器网络</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🤖相关书籍" class="dropdown-title"><a href="/vuepress-interview-github/web/" class="link-title">🤖相关书籍</a> <span class="title" style="display:none;">🤖相关书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress-interview-github/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/vuepress-interview-github/note/Webpack/" class="nav-link">Webpack笔记</a></li></ul></li><li class="dropdown-item"><h4>JS/TS教程</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress-interview-github/note/break/" class="nav-link">《现代JavaScript》教程</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/vuepress-interview-github/tools/" class="nav-link">🔧工具方法</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🍎收藏" class="dropdown-title"><a href="/vuepress-interview-github/pages/beb6c0bd8a66cea6/" class="link-title">🍎收藏</a> <span class="title" style="display:none;">🍎收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/pages/beb6c0bd8a66cea6/" class="nav-link">网站</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/pages/eee83a9211a70f9d/" class="nav-link">资源</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/pages/12df8ace52d493f6/" class="nav-link">Vue资源</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🌐索引" class="dropdown-title"><a href="/vuepress-interview-github/archives/" class="link-title">🌐索引</a> <span class="title" style="display:none;">🌐索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/vuepress-interview-github/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com//caidix/vuepress-interview-github" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>简介</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript 基础知识</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据类型</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>函数进阶内容</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepress-interview-github/pages/fbe924/" class="sidebar-link">构造函数</a></li><li><a href="/vuepress-interview-github/pages/b8891e/" class="sidebar-link">this原理</a></li><li><a href="/vuepress-interview-github/pages/3f5c1b/" class="sidebar-link">递归和堆栈</a></li><li><a href="/vuepress-interview-github/pages/8aba35/" class="sidebar-link">全局对象</a></li><li><a href="/vuepress-interview-github/pages/90b82a/" class="sidebar-link">装饰器模式和转发，call/apply</a></li><li><a href="/vuepress-interview-github/pages/0bcc42/" class="sidebar-link">Rest 参数与 Spread 语法</a></li><li><a href="/vuepress-interview-github/pages/4812d2/" class="sidebar-link">函数对象，NFE</a></li><li><a href="/vuepress-interview-github/pages/e65e21/" class="sidebar-link">函数绑定</a></li><li><a href="/vuepress-interview-github/pages/bed8a0/" aria-current="page" class="active sidebar-link">变量作用域，闭包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/vuepress-interview-github/pages/bed8a0/#代码块" class="sidebar-link">代码块</a></li><li class="sidebar-sub-header level2"><a href="/vuepress-interview-github/pages/bed8a0/#嵌套函数" class="sidebar-link">嵌套函数</a></li><li class="sidebar-sub-header level2"><a href="/vuepress-interview-github/pages/bed8a0/#词法环境" class="sidebar-link">词法环境</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/vuepress-interview-github/pages/bed8a0/#step-1-变量" class="sidebar-link">Step 1. 变量</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-interview-github/pages/bed8a0/#step-2-函数声明" class="sidebar-link">Step 2. 函数声明</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-interview-github/pages/bed8a0/#step-3-内部和外部的词法环境" class="sidebar-link">Step 3. 内部和外部的词法环境</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-interview-github/pages/bed8a0/#step-4-返回函数" class="sidebar-link">Step 4. 返回函数</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/vuepress-interview-github/pages/bed8a0/#垃圾收集" class="sidebar-link">垃圾收集</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/vuepress-interview-github/pages/bed8a0/#实际开发中的优化" class="sidebar-link">实际开发中的优化</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/vuepress-interview-github/pages/bed8a0/#实例" class="sidebar-link">实例</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/vuepress-interview-github/pages/bed8a0/#函数会选择最新的内容吗" class="sidebar-link">函数会选择最新的内容吗？</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-interview-github/pages/bed8a0/#哪些变量可用呢" class="sidebar-link">哪些变量可用呢？</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-interview-github/pages/bed8a0/#counter-是独立的吗" class="sidebar-link">Counter 是独立的吗？</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-interview-github/pages/bed8a0/#counter-对象" class="sidebar-link">Counter 对象]</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-interview-github/pages/bed8a0/#if-内的函数" class="sidebar-link">if 内的函数</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-interview-github/pages/bed8a0/#闭包-sum" class="sidebar-link">闭包 sum</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-interview-github/pages/bed8a0/#变量可见吗" class="sidebar-link">变量可见吗？</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-interview-github/pages/bed8a0/#通过函数筛选" class="sidebar-link">通过函数筛选</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-interview-github/pages/bed8a0/#按字段排序" class="sidebar-link">按字段排序</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-interview-github/pages/bed8a0/#函数大军" class="sidebar-link">函数大军</a></li></ul></li></ul></li><li><a href="/vuepress-interview-github/pages/f2483f/" class="sidebar-link">new Function 语法</a></li><li><a href="/vuepress-interview-github/pages/be3679/" class="sidebar-link">深入理解箭头函数</a></li><li><a href="/vuepress-interview-github/pages/4ba734/" class="sidebar-link">旧时的 &quot;var&quot;</a></li><li><a href="/vuepress-interview-github/pages/421677/" class="sidebar-link">调度：setTimeout 和 setInterval</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>对象属性配置</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>原型，继承</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>类</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>错误处理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Promise，asyncawait</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Generator，高级 iteration</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>模块</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>杂项</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/vuepress-interview-github/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/vuepress-interview-github/categories/?category=%E3%80%8A%E7%8E%B0%E4%BB%A3JavaScript%E3%80%8B%E6%95%99%E7%A8%8B" title="分类" data-v-06225672>《现代JavaScript》教程</a></li><li data-v-06225672><a href="/vuepress-interview-github/categories/?category=%E5%87%BD%E6%95%B0%E8%BF%9B%E9%98%B6%E5%86%85%E5%AE%B9" title="分类" data-v-06225672>函数进阶内容</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/caidix" target="_blank" title="作者" class="beLink" data-v-06225672>CD_wOw</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2020-12-13</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">变量作用域，闭包<!----></h1> <!----> <div class="theme-vdoing-content content__default"><p><code>JavaScript</code> 是一种非常面向函数的语言。它给了我们很大的自由度。在 <code>JavaScript</code> 中，我们可以随时创建函数，可以将函数作为参数传递给另一个函数，并在完全不同的代码位置进行调用。</p> <p>我们已经知道函数可以访问其外部的变量。</p> <p>但是，如果在函数被创建之后，外部变量发生了变化会怎样？函数会获得新值还是旧值？</p> <p>如果将函数作为参数传递并在代码中的另一个位置调用它，该函数将访问的是新位置的外部变量吗？</p> <blockquote><p><strong>我们将在这探讨一下 <code>let/const</code></strong></p> <p>在 JavaScript 中，有三种声明变量的方式：<code>let</code>，<code>const</code>（现代方式），<code>var</code>（过去留下来的方式）。</p> <ul><li>在本文的示例中，我们将使用 <code>let</code> 声明变量。</li> <li>用 <code>const</code> 声明的变量的行为也相同（译注：与 <code>let</code> 在作用域等特性上是相同的），因此，本文也涉及用 <code>const</code> 进行变量声明。</li> <li>旧的 <code>var</code> 与上面两个有着明显的区别，我们将在 <a href="https://zh.javascript.info/var" target="_blank" rel="noopener noreferrer">旧时的 &quot;var&quot;<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 中详细介绍。</li></ul></blockquote> <h2 id="代码块"><a href="#代码块" class="header-anchor">#</a> 代码块</h2> <p>如果在代码块 <code>{...}</code> 内声明了一个变量，那么这个变量只在该代码块内可见。</p> <p>例如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token comment">// 使用在代码块外不可见的局部变量做一些工作</span>

  <span class="token keyword">let</span> message <span class="token operator">=</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 只在此代码块内可见</span>

  <span class="token function">alert</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Hello</span>
<span class="token punctuation">}</span>

<span class="token function">alert</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error: message is not defined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>我们可以使用它来隔离一段代码，该段代码执行自己的任务，并使用仅属于自己的变量：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token comment">// 显示 message</span>
  <span class="token keyword">let</span> message <span class="token operator">=</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">;</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">{</span>
  <span class="token comment">// 显示另一个 message</span>
  <span class="token keyword">let</span> message <span class="token operator">=</span> <span class="token string">&quot;Goodbye&quot;</span><span class="token punctuation">;</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><blockquote><p><strong>这里如果没有代码块则会报错</strong></p> <p>请注意，如果我们使用 <code>let</code> 对已存在的变量进行重复声明，如果对应的变量没有单独的代码块，则会出现错误：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 显示 message</span>
<span class="token keyword">let</span> message <span class="token operator">=</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 显示另一个 message</span>
<span class="token keyword">let</span> message <span class="token operator">=</span> <span class="token string">&quot;Goodbye&quot;</span><span class="token punctuation">;</span> <span class="token comment">// Error: variable already declared</span>
<span class="token function">alert</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></blockquote> <p>对于 <code>if</code>，<code>for</code> 和 <code>while</code> 等，在 <code>{...}</code> 中声明的变量也仅在内部可见：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> phrase <span class="token operator">=</span> <span class="token string">&quot;Hello!&quot;</span><span class="token punctuation">;</span>

  <span class="token function">alert</span><span class="token punctuation">(</span>phrase<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Hello!</span>
<span class="token punctuation">}</span>

<span class="token function">alert</span><span class="token punctuation">(</span>phrase<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error, no such variable!</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>在这儿，当 <code>if</code> 执行完毕，则下面的 <code>alert</code> 将看不到 <code>phrase</code>，因此会出现错误。（译注：就算下面的 <code>alert</code> 想在 <code>if</code> 没执行完成时去取 <code>phrase</code>（虽然这种情况不可能发生）也是取不到的，因为 <code>let</code> 声明的变量在代码块外不可见。）</p> <p>太好了，因为这就允许我们创建特定于 <code>if</code> 分支的块级局部变量。</p> <p>对于 <code>for</code> 和 <code>while</code> 循环也是如此：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 变量 i 仅在这个 for 循环的内部可见</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0，然后是 1，然后是 2</span>
<span class="token punctuation">}</span>

<span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error, no such variable</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>从视觉上看，<code>let i</code> 位于 <code>{...}</code> 之外。但是 <code>for</code> 构造在这里很特殊：在其中声明的变量被视为块的一部分。</p> <h2 id="嵌套函数"><a href="#嵌套函数" class="header-anchor">#</a> 嵌套函数</h2> <p>当一个函数是在另一个函数中创建的时，那么该函数就被称为“嵌套”的。</p> <p>在 JavaScript 中很容易实现这一点。</p> <p>我们可以使用嵌套来组织代码，比如这样：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">sayHiBye</span><span class="token punctuation">(</span><span class="token parameter">firstName<span class="token punctuation">,</span> lastName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">// 辅助嵌套函数使用如下</span>
  <span class="token keyword">function</span> <span class="token function">getFullName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> firstName <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> lastName<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">alert</span><span class="token punctuation">(</span> <span class="token string">&quot;Hello, &quot;</span> <span class="token operator">+</span> <span class="token function">getFullName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">alert</span><span class="token punctuation">(</span> <span class="token string">&quot;Bye, &quot;</span> <span class="token operator">+</span> <span class="token function">getFullName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>这里创建的 <strong>嵌套</strong> 函数 <code>getFullName()</code> 是为了更加方便。它可以访问外部变量，因此可以返回全名。嵌套函数在 JavaScript 中很常见。</p> <p>更有意思的是，可以返回一个嵌套函数：作为一个新对象的属性或作为结果返回。之后可以在其他地方使用。不论在哪里调用，它仍然可以访问相同的外部变量。</p> <p>下面的 <code>makeCounter</code> 创建了一个 “counter” 函数，该函数在每次调用时返回下一个数字：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">makeCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> count<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> counter <span class="token operator">=</span> <span class="token function">makeCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">alert</span><span class="token punctuation">(</span> <span class="token function">counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0</span>
<span class="token function">alert</span><span class="token punctuation">(</span> <span class="token function">counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
<span class="token function">alert</span><span class="token punctuation">(</span> <span class="token function">counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>尽管很简单，但稍加变型就具有很强的实际用途，比如，用作 <a href="https://en.wikipedia.org/wiki/Pseudorandom_number_generator" target="_blank" rel="noopener noreferrer">随机数生成器<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 以生成用于自动化测试的随机数值。</p> <p>这是如何运作的呢？如果我们创建多个计数器，它们会是独立的吗？这里的变量是怎么回事？</p> <p>理解这些内容对于掌握 JavaScript 的整体知识很有帮助，并且对于应对更复杂的场景也很有益处。因此，让我们继续深入探究。</p> <h2 id="词法环境"><a href="#词法环境" class="header-anchor">#</a> 词法环境</h2> <h3 id="step-1-变量"><a href="#step-1-变量" class="header-anchor">#</a> <code>Step 1</code>. 变量</h3> <p>在 <code>JavaScript</code> 中，每个运行的函数，代码块 <code>{...}</code> 以及整个脚本，都有一个被称为 <strong>词法环境（<code>Lexical Environment</code>）</strong> 的内部（隐藏）的关联对象。</p> <p>词法环境对象由两部分组成：</p> <ol><li><strong>环境记录（<code>Environment Record</code>）</strong> —— 一个存储所有局部变量作为其属性（包括一些其他信息，例如 <code>this</code> 的值）的对象。</li> <li>对 <strong>外部词法环境</strong> 的引用，与外部代码相关联。</li></ol> <p>一个“变量”只是 <strong>环境记录</strong> 这个特殊的内部对象的一个属性。“获取或修改变量”意味着“获取或修改词法环境的一个属性”。</p> <p>举个例子，这段没有函数的简单的代码中只有一个词法环境：</p> <p><img src="https://picgoi-mg.oss-cn-beijing.aliyuncs.com/img/20201213002324.png" alt=""></p> <p>这就是所谓的与整个脚本相关联的 <strong>全局</strong> 词法环境。</p> <p>在上面的图片中，矩形表示环境记录（变量存储），箭头表示外部引用。全局词法环境没有外部引用，所以箭头指向了 <code>null</code>。</p> <p>随着代码开始并继续运行，词法环境发生了变化。</p> <p>这是更长的代码：</p> <p><img src="https://picgoi-mg.oss-cn-beijing.aliyuncs.com/img/20201213002407.png" alt=""></p> <p>右侧的矩形演示了执行过程中全局词法环境的变化：</p> <ol><li>当脚本开始运行，词法环境预先填充了所有声明的变量。
<ul><li>最初，它们处于“未初始化（Uninitialized）”状态。这是一种特殊的内部状态，这意味着引擎知道变量，但是在用 <code>let</code> 声明前，不能引用它。几乎就像变量不存在一样。</li></ul></li> <li>然后 <code>let phrase</code> 定义出现了。它尚未被赋值，因此它的值为 <code>undefined</code>。从这一刻起，我们就可以使用变量了。</li> <li><code>phrase</code> 被赋予了一个值。</li> <li><code>phrase</code> 的值被修改。</li></ol> <p>现在看起来都挺简单的，是吧？</p> <ul><li>变量是特殊内部对象的属性，与当前正在执行的（代码）块/函数/脚本有关。</li> <li>操作变量实际上是操作该对象的属性。</li></ul> <blockquote><p><strong>词法环境是一个规范对象</strong></p> <p>“词法环境”是一个规范对象（specification object）：它仅仅是存在于 <a href="https://tc39.es/ecma262/#sec-lexical-environments" target="_blank" rel="noopener noreferrer">编程语言规范<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 中的“理论上”存在的，用于描述事物如何运作的对象。我们无法在代码中获取该对象并直接对其进行操作。</p> <p>但 JavaScript 引擎同样可以优化它，比如清除未被使用的变量以节省内存和执行其他内部技巧等，但显性行为应该是和上述的无差。</p></blockquote> <h3 id="step-2-函数声明"><a href="#step-2-函数声明" class="header-anchor">#</a> <code>Step 2</code>. 函数声明</h3> <p>一个函数其实也是一个值，就像变量一样。</p> <p><strong>不同之处在于函数声明的初始化会被立即完成。</strong></p> <p>当创建了一个词法环境（<code>Lexical Environment</code>）时，函数声明会立即变为即用型函数（不像 <code>let</code> 那样直到声明处才可用）。</p> <p>这就是为什么我们可以在（函数声明）的定义之前调用函数声明。</p> <p>例如，这是添加一个函数时全局词法环境的初始状态：</p> <p><img src="https://picgoi-mg.oss-cn-beijing.aliyuncs.com/img/20201213002517.png" alt=""></p> <p>正常来说，这种行为仅适用于函数声明，而不适用于我们将函数分配给变量的函数表达式，例如 <code>let say = function(name)...</code>。</p> <h3 id="step-3-内部和外部的词法环境"><a href="#step-3-内部和外部的词法环境" class="header-anchor">#</a> <code>Step 3</code>. 内部和外部的词法环境</h3> <p>在一个函数运行时，在调用刚开始时，会自动创建一个新的词法环境以存储这个调用的局部变量和参数。</p> <p>例如，对于 <code>say(&quot;John&quot;)</code>，它看起来像这样（当前执行位置在箭头标记的那一行上）：</p> <p><img src="https://picgoi-mg.oss-cn-beijing.aliyuncs.com/img/20201213002603.png" alt=""></p> <p>在这个函数调用期间，我们有两个词法环境：内部一个（用于函数调用）和外部一个（全局）：</p> <ul><li>内部词法环境与 <code>say</code> 的当前执行相对应。它具有一个单独的属性：<code>name</code>，函数的参数。我们调用的是 <code>say(&quot;John&quot;)</code>，所以 <code>name</code> 的值为 <code>&quot;John&quot;</code>。</li> <li>外部词法环境是全局词法环境。它具有 <code>phrase</code> 变量和函数本身。</li></ul> <p>内部词法环境引用了 <code>outer</code>。</p> <p><strong>当代码要访问一个变量时 —— 首先会搜索内部词法环境，然后搜索外部环境，然后搜索更外部的环境，以此类推，直到全局词法环境。</strong></p> <p>如果在任何地方都找不到这个变量，那么在严格模式下就会报错（在非严格模式下，为了向下兼容，给未定义的变量赋值会创建一个全局变量）。</p> <p>在这个示例中，搜索过程如下：</p> <ul><li>对于 <code>name</code> 变量，当 <code>say</code> 中的 <code>alert</code> 试图访问 <code>name</code> 时，会立即在内部词法环境中找到它。</li> <li>当它试图访问 <code>phrase</code> 时，然而内部没有 <code>phrase</code>，所以它顺着对外部词法环境的引用找到了它。</li></ul> <p><img src="https://picgoi-mg.oss-cn-beijing.aliyuncs.com/img/20201213002635.png" alt=""></p> <h3 id="step-4-返回函数"><a href="#step-4-返回函数" class="header-anchor">#</a> <code>Step 4</code>. 返回函数</h3> <p>让我们回到 <code>makeCounter</code> 这个例子。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">makeCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> count<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> counter <span class="token operator">=</span> <span class="token function">makeCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>在每次 <code>makeCounter()</code> 调用的开始，都会创建一个新的词法环境对象，以存储该 <code>makeCounter</code> 运行时的变量。</p> <p>因此，我们有两层嵌套的词法环境，就像上面的示例一样：</p> <p><img src="https://picgoi-mg.oss-cn-beijing.aliyuncs.com/img/20201213002730.png" alt=""></p> <p>不同的是，在执行 <code>makeCounter()</code> 的过程中创建了一个仅占一行的嵌套函数：<code>return count++</code>。我们尚未运行它，仅创建了它。</p> <p>所有的函数在“诞生”时都会记住创建它们的词法环境。从技术上讲，这里没有什么魔法：所有函数都有名为 <code>[[Environment]]</code> 的隐藏属性，该属性保存了对创建该函数的词法环境的引用。</p> <p><img src="https://picgoi-mg.oss-cn-beijing.aliyuncs.com/img/20201213002809.png" alt=""></p> <p>因此，<code>counter.[[Environment]]</code> 有对 <code>{count: 0}</code> 词法环境的引用。这就是函数记住它创建于何处的方式，与函数被在哪儿调用无关。<code>[[Environment]]</code> 引用在函数创建时被设置并永久保存。</p> <p>稍后，当调用 <code>counter()</code> 时，会为该调用创建一个新的词法环境，并且其外部词法环境引用获取于 <code>counter.[[Environment]]</code>：</p> <p><img src="https://picgoi-mg.oss-cn-beijing.aliyuncs.com/img/20201213002854.png" alt=""></p> <p>现在，当 <code>counter()</code> 中的代码查找 <code>count</code> 变量时，它首先搜索自己的词法环境（为空，因为那里没有局部变量），然后是外部 <code>makeCounter()</code> 的词法环境，并且在哪里找到就在哪里修改。</p> <p><strong>在变量所在的词法环境中更新变量。</strong></p> <p>这是执行后的状态：</p> <p><img src="https://picgoi-mg.oss-cn-beijing.aliyuncs.com/img/20201213002929.png" alt=""></p> <p>如果我们调用 <code>counter()</code> 多次，<code>count</code> 变量将在同一位置增加到 <code>2</code>，<code>3</code> 等。</p> <blockquote><p><strong>闭包</strong></p> <p>开发者通常应该都知道“闭包”这个通用的编程术语。</p> <p><a href="https://en.wikipedia.org/wiki/Closure_(computer_programming)" target="_blank" rel="noopener noreferrer">闭包<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 是指内部函数总是可以访问其所在的外部函数中声明的变量和参数，即使在其外部函数被返回（寿命终结）了之后。在某些编程语言中，这是不可能的，或者应该以特殊的方式编写函数来实现。但是如上所述，在 JavaScript 中，所有函数都是天生闭包的（只有一个例外，将在 <a href="https://zh.javascript.info/new-function" target="_blank" rel="noopener noreferrer">&quot;new Function&quot; 语法<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 中讲到）。</p> <p>也就是说：JavaScript 中的函数会自动通过隐藏的 <code>[[Environment]]</code> 属性记住创建它们的位置，所以它们都可以访问外部变量。</p> <p>在面试时，前端开发者通常会被问到“什么是闭包？”，正确的回答应该是闭包的定义，并解释清楚为什么 JavaScript 中的所有函数都是闭包的，以及可能的关于 <code>[[Environment]]</code> 属性和词法环境原理的技术细节。</p></blockquote> <h2 id="垃圾收集"><a href="#垃圾收集" class="header-anchor">#</a> 垃圾收集</h2> <p>通常，函数调用完成后，会将词法环境和其中的所有变量从内存中删除。因为现在没有任何对它们的引用了。与 <code>JavaScript</code> 中的任何其他对象一样，词法环境仅在可达时才会被保留在内存中。</p> <p>但是，如果有一个嵌套的函数在函数结束后仍可达，则它将具有引用词法环境的 <code>[[Environment]]</code> 属性。</p> <p>在下面这个例子中，即使在函数执行完成后，词法环境仍然可达。因此，此嵌套函数仍然有效。</p> <p>例如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> g <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// g.[[Environment]] 存储了对相应 f() 调用的词法环境的引用</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>请注意，如果多次调用 <code>f()</code>，并且返回的函数被保存，那么所有相应的词法环境对象也会保留在内存中。下面代码中有三个这样的函数：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 数组中的 3 个函数，每个都与来自对应的 f() 的词法环境相关联</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>当词法环境对象变得不可达时，它就会死去（就像其他任何对象一样）。换句话说，它仅在至少有一个嵌套函数引用它时才存在。</p> <p>在下面的代码中，嵌套函数被删除后，其封闭的词法环境（以及其中的 <code>value</code>）也会被从内存中删除：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> g <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 当 g 函数存在时，该值会被保留在内存中</span>

g <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// ……现在内存被清理了</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="实际开发中的优化"><a href="#实际开发中的优化" class="header-anchor">#</a> 实际开发中的优化</h3> <p>正如我们所看到的，理论上当函数可达时，它外部的所有变量也都将存在。</p> <p>但在实际中，<code>JavaScript</code> 引擎会试图优化它。它们会分析变量的使用情况，如果从代码中可以明显看出有未使用的外部变量，那么就会将其删除。</p> <p><strong>在 <code>V8</code>（<code>Chrome</code>，<code>Edge</code>，<code>Opera</code>）中的一个重要的副作用是，此类变量在调试中将不可用。</strong></p> <p>打开 <code>Chrome</code> 浏览器的开发者工具，并尝试运行下面的代码。</p> <p>当代码执行暂停时，在控制台中输入 <code>alert(value)</code>。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">debugger</span><span class="token punctuation">;</span> <span class="token comment">// 在 Console 中：输入 alert(value); No such variable!</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> g<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> g <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>正如你所见的 —— <code>No such variable</code>! 理论上，它应该是可以访问的，但引擎把它优化掉了。</p> <p>这可能会导致有趣的（如果不是那么耗时的）调试问题。其中之一 —— 我们可以看到的是一个同名的外部变量，而不是预期的变量：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token string">&quot;Surprise!&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token string">&quot;the closest value&quot;</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">debugger</span><span class="token punctuation">;</span> <span class="token comment">// 在 console 中：输入 alert(value); Surprise!</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> g<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> g <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><code>V8</code> 引擎的这个特性你真的应该知道。如果你要使用 <code>Chrome/Edge/Opera</code> 进行代码调试，迟早会遇到这样的问题。</p> <p>这不是调试器的 <code>bug</code>，而是 <code>V8</code> 的一个特别的特性。也许以后会被修改。你始终可以通过运行本文中的示例来进行检查。</p> <h2 id="实例"><a href="#实例" class="header-anchor">#</a> 实例</h2> <h3 id="函数会选择最新的内容吗"><a href="#函数会选择最新的内容吗" class="header-anchor">#</a> 函数会选择最新的内容吗？</h3> <p>函数 <code>sayHi</code> 使用外部变量。当函数运行时，将使用哪个值？</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;Hi, &quot;</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

name <span class="token operator">=</span> <span class="token string">&quot;Pete&quot;</span><span class="token punctuation">;</span>

<span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 会显示什么：&quot;John&quot; 还是 &quot;Pete&quot;？</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>这种情况在浏览器和服务器端开发中都很常见。一个函数可能被计划在创建之后一段时间后才执行，例如在用户行为或网络请求之后。</p> <p>因此，问题是：它会接收最新的修改吗？</p> <blockquote><p>答案：<strong>Pete</strong>。</p> <p>函数将从内到外依次在对应的词法环境中寻找目标变量，它使用最新的值。</p> <p>旧变量值不会保存在任何地方。当一个函数想要一个变量时，它会从自己的词法环境或外部词法环境中获取当前值。</p></blockquote> <h3 id="哪些变量可用呢"><a href="#哪些变量可用呢" class="header-anchor">#</a> 哪些变量可用呢？</h3> <p>下面的 <code>makeWorker</code> 函数创建了另一个函数并返回该函数。可以在其他地方调用这个新函数。</p> <p>它是否可以从它被创建的位置或调用位置（或两者）访问外部变量？</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">makeWorker</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">&quot;Pete&quot;</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// create a function</span>
<span class="token keyword">let</span> work <span class="token operator">=</span> <span class="token function">makeWorker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// call it</span>
<span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 会显示什么？</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>会显示哪个值？“Pete” 还是 “John”？</p> <blockquote><p>答案：<strong>Pete</strong>.</p> <p>下方代码中的函数 <code>work()</code> 在其被创建的位置通过外部词法环境引用获取 <code>name</code>：</p> <p><img src="https://picgoi-mg.oss-cn-beijing.aliyuncs.com/img/20201213003257.png" alt=""></p> <p>所以这里的结果是 <code>&quot;Pete&quot;</code>。</p> <p>但如果在 <code>makeWorker()</code> 中没有 <code>let name</code>，那么将继续向外搜索并最终找到全局变量，正如我们可以从上图中看到的那样。在这种情况下，结果将是 <code>&quot;John&quot;</code>。</p></blockquote> <h3 id="counter-是独立的吗"><a href="#counter-是独立的吗" class="header-anchor">#</a> <code>Counter</code> 是独立的吗？</h3> <p>在这儿我们用相同的 <code>makeCounter</code> 函数创建了两个计数器（<code>counters</code>）：<code>counter</code> 和 <code>counter2</code>。</p> <p>它们是独立的吗？第二个 <code>counter</code> 会显示什么？<code>0,1</code> 或 <code>2,3</code> 还是其他？</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">makeCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> count<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> counter <span class="token operator">=</span> <span class="token function">makeCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> counter2 <span class="token operator">=</span> <span class="token function">makeCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">alert</span><span class="token punctuation">(</span> <span class="token function">counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0</span>
<span class="token function">alert</span><span class="token punctuation">(</span> <span class="token function">counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>

<span class="token function">alert</span><span class="token punctuation">(</span> <span class="token function">counter2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ?</span>
<span class="token function">alert</span><span class="token punctuation">(</span> <span class="token function">counter2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ?</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>解决方案：</p> <blockquote><p>答案是：<strong>0，1。</strong></p> <p>函数 <code>counter</code> 和 <code>counter2</code> 是通过 <code>makeCounter</code> 的不同调用创建的。</p> <p>因此，它们具有独立的外部词法环境，每一个都有自己的 <code>count</code>。</p></blockquote> <h3 id="counter-对象"><a href="#counter-对象" class="header-anchor">#</a> <code>Counter</code> 对象]</h3> <p>这里通过构造函数创建了一个 counter 对象。</p> <p>它能正常工作吗？它会显示什么呢？</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">up</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">++</span>count<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">down</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">--</span>count<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> counter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">alert</span><span class="token punctuation">(</span> counter<span class="token punctuation">.</span><span class="token function">up</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ?</span>
<span class="token function">alert</span><span class="token punctuation">(</span> counter<span class="token punctuation">.</span><span class="token function">up</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ?</span>
<span class="token function">alert</span><span class="token punctuation">(</span> counter<span class="token punctuation">.</span><span class="token function">down</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ?</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>解决方案：</p> <blockquote><p>当然行得通。</p> <p>这两个嵌套函数都是在同一个词法环境中创建的，所以它们可以共享对同一个 count 变量的访问：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">up</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">++</span>count<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">down</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">--</span>count<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> counter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">alert</span><span class="token punctuation">(</span> counter<span class="token punctuation">.</span><span class="token function">up</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
<span class="token function">alert</span><span class="token punctuation">(</span> counter<span class="token punctuation">.</span><span class="token function">up</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
<span class="token function">alert</span><span class="token punctuation">(</span> counter<span class="token punctuation">.</span><span class="token function">down</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></blockquote> <h3 id="if-内的函数"><a href="#if-内的函数" class="header-anchor">#</a> <code>if</code> 内的函数</h3> <p>看看下面这个代码。最后一行代码的执行结果是什么？</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> phrase <span class="token operator">=</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>phrase<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>解决方案：</p> <blockquote><p>答案：<strong>error</strong>。</p> <p>函数 <code>sayHi</code> 是在 <code>if</code> 内声明的，所以它只存在于 <code>if</code> 中。外部是没有 <code>sayHi</code> 的。</p></blockquote> <h3 id="闭包-sum"><a href="#闭包-sum" class="header-anchor">#</a> 闭包 <code>sum</code></h3> <p>编写一个像 <code>sum(a)(b) = a+b</code> 这样工作的 <code>sum</code> 函数。</p> <p>是的，就是这种通过双括号的方式（并不是错误）。</p> <p>举个例子：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">3</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">4</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>解决方案：</p> <blockquote><p>为了使第二个括号有效，第一个（括号）必须返回一个函数。</p> <p>就像这样：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token comment">// 从外部词法环境获得 &quot;a&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token function">alert</span><span class="token punctuation">(</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
<span class="token function">alert</span><span class="token punctuation">(</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 4</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></blockquote> <h3 id="变量可见吗"><a href="#变量可见吗" class="header-anchor">#</a> 变量可见吗？</h3> <p>下面这段代码的结果会是什么？</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ?</span>

  <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><code>P.S</code>. 这个任务有一个陷阱。解决方案并不明显。</p> <p>解决方案：</p> <blockquote><p>答案：<strong>error</strong>。</p> <p>你运行一下试试：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ReferenceError: Cannot access 'x' before initialization</span>
  <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>在这个例子中，我们可以观察到“不存在”的变量和“未初始化”的变量之间的特殊差异。</p> <p>你可能已经在变量作用域，闭包中学过了，从程序执行进入代码块（或函数）的那一刻起，变量就开始进入“未初始化”状态。它一直保持未初始化状态，直至程序执行到相应的 <code>let</code> 语句。</p> <p>换句话说，一个变量从技术的角度来讲是存在的，但是在 <code>let</code> 之前还不能使用。</p> <p>下面的这段代码证实了这一点。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 引擎从函数开始就知道局部变量 x，</span>
  <span class="token comment">// 但是变量 x 一直处于“未初始化”（无法使用）的状态，直到结束 let（“死区”）</span>
  <span class="token comment">// 因此答案是 error</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ReferenceError: Cannot access 'x' before initialization</span>

  <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>变量暂时无法使用的区域（从代码块的开始到 <code>let</code>）有时被称为“死区”。</p></blockquote> <h3 id="通过函数筛选"><a href="#通过函数筛选" class="header-anchor">#</a> 通过函数筛选</h3> <p>我们有一个内建的数组方法 <code>arr.filter(f)</code>。它通过函数 <code>f</code> 过滤元素。如果它返回 <code>true</code>，那么该元素会被返回到结果数组中。</p> <p>制造一系列“即用型”过滤器：</p> <ul><li><code>inBetween(a, b)</code> —— 在 <code>a</code> 和 <code>b</code> 之间或与它们相等（包括）。</li> <li><code>inArray([...])</code> —— 包含在给定的数组中。</li></ul> <p>用法如下所示：</p> <ul><li><code>arr.filter(inBetween(3,6))</code> —— 只挑选范围在 3 到 6 的值。</li> <li><code>arr.filter(inArray([1,2,3]))</code> —— 只挑选与 <code>[1,2,3]</code> 中的元素匹配的元素。</li></ul> <p>例如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/* .. inBetween 和 inArray 的代码 */</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token function">alert</span><span class="token punctuation">(</span> arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">inBetween</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3,4,5,6</span>

<span class="token function">alert</span><span class="token punctuation">(</span> arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">inArray</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1,2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>解决方案：</p> <blockquote><h4 id="inbetween-筛选器"><a href="#inbetween-筛选器" class="header-anchor">#</a> <code>inBetween</code> 筛选器</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">inBetween</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">&gt;=</span> a <span class="token operator">&amp;&amp;</span> x <span class="token operator">&lt;=</span> b<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span> arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">inBetween</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3,4,5,6</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="inarray-筛选器"><a href="#inarray-筛选器" class="header-anchor">#</a> <code>inArray</code> 筛选器</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">inArray</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span> arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">inArray</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1,2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></blockquote> <h3 id="按字段排序"><a href="#按字段排序" class="header-anchor">#</a> 按字段排序</h3> <p>我们有一组要排序的对象：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> users <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token literal-property property">surname</span><span class="token operator">:</span> <span class="token string">&quot;Johnson&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Pete&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token literal-property property">surname</span><span class="token operator">:</span> <span class="token string">&quot;Peterson&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Ann&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token literal-property property">surname</span><span class="token operator">:</span> <span class="token string">&quot;Hathaway&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>通常的做法应该是这样的：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 通过 name (Ann, John, Pete)</span>
users<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span>name <span class="token operator">&gt;</span> b<span class="token punctuation">.</span>name <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 通过 age (Pete, Ann, John)</span>
users<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span>age <span class="token operator">&gt;</span> b<span class="token punctuation">.</span>age <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>我们可以让它更加简洁吗，比如这样？</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>users<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token function">byField</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
users<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token function">byField</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这样我们就只需要写 <code>byField(fieldName)</code>，而不是写一个函数。</p> <p>编写函数 <code>byField</code> 来实现这个需求。</p> <p>解决方案：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">byField</span><span class="token punctuation">(</span><span class="token parameter">fieldName</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a<span class="token punctuation">[</span>fieldName<span class="token punctuation">]</span> <span class="token operator">&gt;</span> b<span class="token punctuation">[</span>fieldName<span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="函数大军"><a href="#函数大军" class="header-anchor">#</a> 函数大军</h3> <p>下列的代码创建了一个 <code>shooters</code> 数组。</p> <p>每个函数都应该输出其编号。但好像出了点问题……</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">makeArmy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> shooters <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token function-variable function">shooter</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 创建一个 shooter 函数，</span>
      <span class="token function">alert</span><span class="token punctuation">(</span> i <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 应该显示其编号</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    shooters<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>shooter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将此 shooter 函数添加到数组中</span>
    i<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ……返回 shooters 数组</span>
  <span class="token keyword">return</span> shooters<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> army <span class="token operator">=</span> <span class="token function">makeArmy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ……所有的 shooter 显示的都是 10，而不是它们的编号 0, 1, 2, 3...</span>
army<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 编号为 0 的 shooter 显示的是 10</span>
army<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 编号为 1 的 shooter 显示的是 10</span>
army<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 10，其他的也是这样。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>为什么所有的 shooter 显示的都是同样的值？</p> <p>修改代码以使得代码能够按照我们预期的那样工作。</p> <p>解决方案：</p> <blockquote><p>让我们检查一下 <code>makeArmy</code> 内部到底发生了什么，那样答案就显而易见了。</p> <ol><li><p>它创建了一个空数组 <code>shooters</code>：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> shooters <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>在循环中，通过 <code>shooters.push(function)</code> 用函数填充它。</p> <p>每个元素都是函数，所以数组看起来是这样的：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>shooters <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li> <li><p>该数组返回自函数。</p> <p>然后，对数组中的任意数组项的调用，例如调用 <code>army[5]()</code>（它是一个函数），将首先从数组中获取元素 <code>army[5]()</code> 并调用它。</p> <p>那么，为什么所有此类函数都显示的是相同的值，<code>10</code> 呢？</p> <p>这是因为 <code>shooter</code> 函数内没有局部变量 <code>i</code>。当一个这样的函数被调用时，<code>i</code> 是来自于外部词法环境的。</p> <p>那么，<code>i</code> 的值是什么呢？</p> <p>如果我们看一下源代码：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">makeArmy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token function-variable function">shooter</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// shooter 函数</span>
      <span class="token function">alert</span><span class="token punctuation">(</span> i <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 应该显示它自己的编号</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    shooters<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>shooter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将 shooter 函数添加到该数组中</span>
      i<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>……我们可以看到，所有的 <code>shooter</code> 函数都是在 <code>makeArmy()</code> 的词法环境中被创建的。但当 <code>army[5]()</code> 被调用时，<code>makeArmy</code> 已经运行完了，最后 <code>i</code> 的值为 <code>10</code>（<code>while</code> 循环在 <code>i=10</code> 时停止）。</p> <p>因此，所有的 <code>shooter</code> 函数获得的都是外部词法环境中的同一个值，即最后的 <code>i=10</code>。</p> <p><img src="https://picgoi-mg.oss-cn-beijing.aliyuncs.com/img/20201213003913.png" alt=""></p> <p>正如你在上边所看到的那样，在 <code>while {...}</code> 块的每次迭代中，都会创建一个新的词法环境。因此，要解决此问题，我们可以将 <code>i</code> 的值复制到 <code>while {...}</code> 块内的变量中，如下所示：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">makeArmy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> shooters <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> j <span class="token operator">=</span> i<span class="token punctuation">;</span>
      <span class="token keyword">let</span> <span class="token function-variable function">shooter</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// shooter 函数</span>
        <span class="token function">alert</span><span class="token punctuation">(</span> j <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 应该显示它自己的编号</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    shooters<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>shooter<span class="token punctuation">)</span><span class="token punctuation">;</span>
    i<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> shooters<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> army <span class="token operator">=</span> <span class="token function">makeArmy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 现在代码正确运行了</span>
army<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0</span>
army<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>在这里，<code>let j = i</code> 声明了一个“局部迭代”变量 <code>j</code>，并将 <code>i</code> 复制到其中。原始类型是“按值”复制的，因此实际上我们得到的是属于当前循环迭代的独立的 <code>i</code> 的副本。</p> <p>shooter 函数正确运行了，因为 <code>i</code> 值的位置更近了（译注：指转到了更内部的词法环境）。不是在 <code>makeArmy()</code> 的词法环境中，而是在与当前循环迭代相对应的词法环境中：</p> <p><img src="https://picgoi-mg.oss-cn-beijing.aliyuncs.com/img/20201213003942.png" alt=""></p> <p>如果我们一开始使用 <code>for</code> 循环，也可以避免这样的问题，像这样：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">makeArmy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">let</span> shooters <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token function-variable function">shooter</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// shooter 函数</span>
      <span class="token function">alert</span><span class="token punctuation">(</span> i <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 应该显示它自己的编号</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    shooters<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>shooter<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> shooters<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> army <span class="token operator">=</span> <span class="token function">makeArmy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

army<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0</span>
army<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>这本质上是一样的，因为 <code>for</code> 循环在每次迭代中，都会生成一个带有自己的变量 <code>i</code> 的新词法环境。因此，在每次迭代中生成的 <code>shooter</code> 函数引用的都是自己的 <code>i</code>。</p> <p><img src="https://picgoi-mg.oss-cn-beijing.aliyuncs.com/img/20201213004015.png" alt=""></p> <p>此外，确实存在有些人相较于 <code>for</code> 更喜欢 <code>while</code>，以及其他情况。</p></li></ol></blockquote></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com//caidix/vuepress-interview-github/edit/master/docs/《现代JavaScript》教程/20.函数进阶内容/40.变量作用域，闭包.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/vuepress-interview-github/tags/?tag=%E7%8E%B0%E4%BB%A3JavaScript" title="标签">#现代JavaScript</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021/08/22, 01:09:59</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/vuepress-interview-github/pages/e65e21/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">函数绑定</div></a> <a href="/vuepress-interview-github/pages/f2483f/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">new Function 语法</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/vuepress-interview-github/pages/e65e21/" class="prev">函数绑定</a></span> <span class="next"><a href="/vuepress-interview-github/pages/f2483f/">new Function 语法</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/vuepress-interview-github/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/vuepress-interview-github/pages/7f7024/"><div>
            gsap动画库学习笔记 - 持续~
            <!----></div></a> <span class="date">06-05</span></dt></dl><dl><dd>02</dd> <dt><a href="/vuepress-interview-github/pages/af84a4/"><div>
            远程组件加载方案笔记
            <!----></div></a> <span class="date">05-03</span></dt></dl><dl><dd>03</dd> <dt><a href="/vuepress-interview-github/pages/cd04a9/"><div>
            小程序使用笔记
            <!----></div></a> <span class="date">03-29</span></dt></dl> <dl><dd></dd> <dt><a href="/vuepress-interview-github/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:380141132@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/caidix" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2020-2023
    <span>CD | <a href="https://github.com/caidix" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div><div></div></div></div>
    <script src="/vuepress-interview-github/assets/js/app.4e548d7f.js" defer></script><script src="/vuepress-interview-github/assets/js/2.e83f1016.js" defer></script><script src="/vuepress-interview-github/assets/js/216.fe74516c.js" defer></script>
  </body>
</html>
