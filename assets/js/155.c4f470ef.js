(window.webpackJsonp=window.webpackJsonp||[]).push([[155],{470:function(e,a,s){"use strict";s.r(a);var t=s(1),r=Object(t.a)({},(function(){var e=this,a=e._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[a("code",[e._v("webpack")]),e._v(" 可以监听文件变化，当它们修改后会重新编译。这个页面介绍了如何启用这个功能，以及当 watch 无法正常运行的时候你可以做的一些调整。")]),e._v(" "),a("h2",{attrs:{id:"watch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#watch"}},[e._v("#")]),e._v(" "),a("code",[e._v("watch")])]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("type")]),e._v(": "),a("code",[e._v("boolean")])])]),e._v(" "),a("p",[e._v("启用 Watch 模式。这意味着在初始构建之后，"),a("code",[e._v("webpack")]),e._v(" 将继续监听任何已解析文件的更改。Watch 模式默认关闭。")]),e._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("watch")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("blockquote",[a("p",[a("em",[a("code",[e._v("webpack-dev-server")]),e._v(" 和 "),a("code",[e._v("webpack-dev-middleware")]),e._v("里 Watch 模式默认开启。")])])]),e._v(" "),a("h2",{attrs:{id:"watchoptions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#watchoptions"}},[e._v("#")]),e._v(" "),a("code",[e._v("watchOptions")])]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("type")]),e._v(": "),a("code",[e._v("object")])])]),e._v(" "),a("p",[e._v("一组用来定制 Watch 模式的选项：")]),e._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("watchOptions")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("aggregateTimeout")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("300")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("poll")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1000")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("h2",{attrs:{id:"watchoptions-aggregatetimeout"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#watchoptions-aggregatetimeout"}},[e._v("#")]),e._v(" "),a("code",[e._v("watchOptions.aggregateTimeout")])]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("type")]),e._v(": "),a("code",[e._v("number")])])]),e._v(" "),a("p",[e._v("当第一个文件更改，会在重新构建前增加延迟。这个选项允许 "),a("code",[e._v("webpack")]),e._v(" 将这段时间内进行的任何其他更改都聚合到一次重新构建里。以毫秒为单位：")]),e._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("aggregateTimeout")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("300")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// 默认值")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h2",{attrs:{id:"watchoptions-ignored"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#watchoptions-ignored"}},[e._v("#")]),e._v(" "),a("code",[e._v("watchOptions.ignored")])]),e._v(" "),a("p",[e._v("对于某些系统，监听大量文件系统会导致大量的 CPU 或内存占用。这个选项可以排除一些巨大的文件夹，例如 "),a("code",[e._v("node_modules")]),e._v("：")]),e._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("ignored")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[e._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[e._v("node_modules")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[e._v("/")])]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("也可以使用 "),a("a",{attrs:{href:"https://github.com/micromatch/anymatch",target:"_blank",rel:"noopener noreferrer"}},[e._v("anymatch"),a("OutboundLink")],1),e._v(" 模式：")]),e._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("ignored")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"files/**/*.js"')]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h2",{attrs:{id:"watchoptions-poll"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#watchoptions-poll"}},[e._v("#")]),e._v(" "),a("code",[e._v("watchOptions.poll")])]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("type")]),e._v(": "),a("code",[e._v("boolean, number")])])]),e._v(" "),a("p",[e._v("通过传递 "),a("code",[e._v("true")]),e._v(" 开启 "),a("a",{attrs:{href:"https://whatis.techtarget.com/definition/polling",target:"_blank",rel:"noopener noreferrer"}},[e._v("polling"),a("OutboundLink")],1),e._v("，或者指定毫秒为单位进行轮询。")]),e._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("poll")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1000")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// 每秒检查一次变动")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("blockquote",[a("p",[a("em",[e._v("如果监听没生效，试试这个选项吧。Watch 在 NFS 和 "),a("code",[e._v("VirtualBox")]),e._v(" 机器上不适用。")])])]),e._v(" "),a("h2",{attrs:{id:"info-verbosity"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#info-verbosity"}},[e._v("#")]),e._v(" "),a("code",[e._v("info-verbosity")])]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("type")]),e._v(": "),a("code",[e._v("string")]),e._v(": "),a("code",[e._v("none")]),e._v(" "),a("code",[e._v("info")]),e._v(" "),a("code",[e._v("verbose")])])]),e._v(" "),a("p",[e._v("控制生命周期消息的详细程度，例如 "),a("code",[e._v("Started watching files(开始监听文件)...")]),e._v(" 日志。将 "),a("code",[e._v("info-verbosity")]),e._v(" 设置为 "),a("code",[e._v("verbose")]),e._v("，还会额外在增量构建的开始和结束时，向控制台发送消息。"),a("code",[e._v("info-verbosity")]),e._v(" 默认设置为 "),a("code",[e._v("info")]),e._v("。")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("webpack "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--watch")]),e._v(" --info-verbosity verbose\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h2",{attrs:{id:"故障排除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#故障排除"}},[e._v("#")]),e._v(" 故障排除")]),e._v(" "),a("p",[e._v("如果您遇到任何问题，请查看以下注意事项。对于 "),a("code",[e._v("webpack")]),e._v(" 为何会忽略文件修改，这里有多种原因")]),e._v(" "),a("h3",{attrs:{id:"发现修改-但并未做处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#发现修改-但并未做处理"}},[e._v("#")]),e._v(" 发现修改，但并未做处理")]),e._v(" "),a("p",[e._v("在运行 "),a("code",[e._v("webpack")]),e._v(" 时，通过使用 --progress 标志，来验证文件修改后，是否没有通知 "),a("code",[e._v("webpack")]),e._v("。如果进度显示保存，但没有输出文件，则可能是配置问题，而不是文件监视问题。")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("webpack "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--watch")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--progress")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h3",{attrs:{id:"没有足够的文件观察者"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#没有足够的文件观察者"}},[e._v("#")]),e._v(" 没有足够的文件观察者")]),e._v(" "),a("p",[e._v("确认系统中有足够多的文件观察者。如果这个值太低，"),a("code",[e._v("webpack")]),e._v(" 中的文件观察者将无法识别修改：")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" /proc/sys/fs/inotify/max_user_watches\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("Arch 用户，请将 "),a("code",[e._v("fs.inotify.max_user_watches=524288")]),e._v(" 添加到 "),a("code",[e._v("/etc/sysctl.d/99-sysctl.conf")]),e._v(" 中，然后执行 "),a("code",[e._v("sysctl --system")]),e._v("。 "),a("code",[e._v("Ubuntu")]),e._v(" 用户（可能还有其他用户）请执行："),a("code",[e._v("echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf && sudo sysctl -p")]),e._v("。")]),e._v(" "),a("h2",{attrs:{id:"macos-fsevents-bug"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#macos-fsevents-bug"}},[e._v("#")]),e._v(" "),a("code",[e._v("MacOS fsevents Bug")])]),e._v(" "),a("p",[e._v("在 "),a("code",[e._v("MacOS")]),e._v(" 中，某些情况下文件夹可能会损坏。请参阅"),a("a",{attrs:{href:"https://github.com/livereload/livereload-site/blob/master/livereload.com/_articles/troubleshooting/os-x-fsevents-bug-may-prevent-monitoring-of-certain-folders.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("这篇文章"),a("OutboundLink")],1),e._v("。")]),e._v(" "),a("h3",{attrs:{id:"windows-paths"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#windows-paths"}},[e._v("#")]),e._v(" Windows Paths")]),e._v(" "),a("p",[e._v("因为 "),a("code",[e._v("webpack")]),e._v(" 期望获得多个配置选项的绝对路径（如 "),a("code",[e._v('__dirname + "/app/folder"')]),e._v("），所以 Windows 的路径分隔符 "),a("code",[e._v("\\")]),e._v(" 可能会破坏某些功能。")]),e._v(" "),a("p",[e._v("使用正确的分隔符。即 "),a("code",[e._v('path.resolve(__dirname, "app/folder")')]),e._v(" 或 "),a("code",[e._v('path.join(__dirname, "app", "folder")')]),e._v("。")]),e._v(" "),a("h3",{attrs:{id:"vim"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vim"}},[e._v("#")]),e._v(" "),a("code",[e._v("Vim")])]),e._v(" "),a("p",[e._v("在某些机器上，Vim 预先将 "),a("a",{attrs:{href:"http://vimdoc.sourceforge.net/htmldoc/options.html#'backupcopy'",target:"_blank",rel:"noopener noreferrer"}},[e._v("backupcopy 选项"),a("OutboundLink")],1),e._v(" 设置为 "),a("code",[e._v("auto")]),e._v("。这可能会导致系统的文件监视机制出现问题。将此选项设置为 "),a("code",[e._v("yes")]),e._v(" 可以确保创建文件的副本，并在保存时覆盖原始文件。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(":set backupcopy=yes.\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h3",{attrs:{id:"在-webstorm-中保存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在-webstorm-中保存"}},[e._v("#")]),e._v(" 在 "),a("code",[e._v("WebStorm")]),e._v(" 中保存")]),e._v(" "),a("p",[e._v("使用 "),a("code",[e._v("JetBrains WebStorm IDE")]),e._v(" 时，你可能会发现保存修改过的文件，并不会按照预期触发观察者。尝试在设置中禁用"),a("code",[e._v("安全写入(safe write)")]),e._v("选项，该选项确定在原文件被覆盖之前，文件是否先保存到临时位置：取消选中 "),a("code",[e._v('File > Settings... > System Settings > Use "safe write" (save changes to a temporary file first)')]),e._v("。")])])}),[],!1,null,null,null);a.default=r.exports}}]);